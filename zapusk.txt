docker-compose down
docker rm nats-server
docker-compose up -d nats
docker ps | grep nats

python3 -m venv venv
source venv/bin/activate

pip install -r requirements.txt

python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

wscat -c ws://127.0.0.1:8000/api/v1/ws/weather

{"type": "ping"}

nats sub ">"

nats pub weather.commands '{"command": "run_background_task"}'

nats pub weather.updates '{"type": "manual_update", "city": "Казань", "temp": 25}'

nats pub "weather.commands" '{"command": "test"}'

curl -X POST "http://localhost:8000/api/v1/weather" \
  -H "Content-Type: application/json" \
  -d '{"city": "ТестовыйГород", "temperature": 25.0, "condition": "солнечно"}'

curl -X POST http://localhost:8000/api/v1/tasks/run

# 1. Получить все записи
curl http://localhost:8000/api/v1/weather

# 2. Найти ID созданной записи "ТестовыйГород"
# (Посмотрите в ответе предыдущей команды)

# 3. Обновить запись (замените {id} на реальный)
curl -X PATCH "http://localhost:8000/api/v1/weather/{id}" \
  -H "Content-Type: application/json" \
  -d '{"temperature": 30.0}'

# 4. Проверить обновление
curl http://localhost:8000/api/v1/weather/city/ТестовыйГород

# 5. Удалить запись
curl -X DELETE "http://localhost:8000/api/v1/weather/{id}"

pip install nats-py
python pub_monitor.py